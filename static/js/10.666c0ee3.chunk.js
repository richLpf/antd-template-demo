(this["webpackJsonpantd-template-project"]=this["webpackJsonpantd-template-project"]||[]).push([[10],{399:function(e,t,n){"use strict";n(216);var r=n(150),a=(n(428),n(449)),c=(n(370),n(373)),i=(n(153),n(69)),o=(n(218),n(161)),l=(n(97),n(47)),u=(n(217),n(98)),s=(n(379),n(151)),d=n(361),b=n.n(d),j=n(388),f=n(364),O=n(43),p=(n(402),n(393)),h=n(0),m=n(171),v=n(760),g=n(761),y=n(342);function x(){return(x=Object(j.a)(b.a.mark((function e(t){var r,a,c,i,o,l,u,s,d,j;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.fields,a=void 0===r?[]:r,c=t.dataSource,i=void 0===c?[]:c,o=t.filename,l=void 0===o?"download":o,u=function(e){try{var t=new Blob([e,{type:"text/csv"}]),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=l,r.click(),window.URL.revokeObjectURL(n)}catch(a){console.error(a)}},e.prev=2,e.next=5,n.e(20).then(n.t.bind(null,751,7));case 5:s=e.sent,d=s.Parser,j=new d({fields:a,withBOM:!0}).parse(i),u(j),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}var w=function(e){return x.apply(this,arguments)},S=n(20);function k(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(n){return t}}var C=n(4),P=p.a.Group,z=Object(h.forwardRef)((function(e,t){var n=e.columns,d=e.storeKey,p=e.dataSource,x=e.rowKey,z=e.query,I=e.leftAction,F=e.download,q=e.filterParams,L=e.size,R=e.useBackendPagination,E=e.useBackendSearch,D=e.useReloadButton,A=e.useSearchInput,N=F||{},T=N.limit,B=N.exportData,K=N.exportQuery,V=Object(h.useState)(p||[]),U=Object(O.a)(V,2),J=U[0],M=U[1],G=Object(h.useState)(0),_=Object(O.a)(G,2),H=_[0],Q=_[1],W=Object(h.useState)(!1),X=Object(O.a)(W,2),Y=X[0],Z=X[1],$=Object(h.useState)(!1),ee=Object(O.a)($,2),te=ee[0],ne=ee[1],re=Object(h.useState)([]),ae=Object(O.a)(re,2),ce=ae[0],ie=ae[1],oe=Object(h.useState)(void 0),le=Object(O.a)(oe,2),ue=le[0],se=le[1],de=Object(h.useState)({Page:1,PageSize:10}),be=Object(O.a)(de,2),je=be[0],fe=be[1];Object(h.useEffect)((function(){Oe(Object(f.a)({},pe()))}),[]);var Oe=Object(h.useCallback)(function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("fetchData",t),Z(!0),e.abrupt("return",z&&z(t).then((function(e){var t=e||{},n=t.Data,r=t.Total;return M(n||[]),Q(r||0),Z(!1),n})).catch((function(e){return Z(!1),e})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[z]);Object(h.useEffect)((function(){var e=n,t=k(d);ie(t?n.filter((function(e){return(t||[]).includes(e.key)})):e)}),[n]),Object(h.useImperativeHandle)(t,(function(){return{fetchData:function(){return Oe(Object(f.a)({},pe()))},data:J}}),[J,Oe]);var pe=Object(h.useCallback)((function(e){var t,n,r=je.Page,a=je.PageSize,c=je.FuzzySearch;return Object(f.a)({},R?Object(f.a)(Object(f.a)({Page:(null===e||void 0===e?void 0:e.Page)||r,PageSize:(null===e||void 0===e?void 0:e.PageSize)||a,FuzzySearch:(null===e||void 0===e?void 0:e.FuzzySearch)||c,sortField:null===e||void 0===e||null===(t=e.sorter)||void 0===t?void 0:t.field,sortOrder:null===e||void 0===e||null===(n=e.sorter)||void 0===n?void 0:n.order},(null===e||void 0===e?void 0:e.filters)?e.filters:{}),q):Object(f.a)({Page:1,PageSize:9999999},q))}),[q,je,R]);Object(h.useEffect)((function(){console.log(ve.current),ve.current(je.Page,je.PageSize||10,R)}),[q]);var he=function(){var e=Object(j.a)(b.a.mark((function e(){var t,n,r,a,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=J,!R){e.next=8;break}return ne(!0),n=K?K(Object(f.a)({},pe())):z(Object(f.a)(Object(f.a)({},pe()),{},{Page:1},T?{PageSize:T}:{})),e.next=6,n.then((function(e){return e.Data})).catch((function(e){return ne(!1),s.b.error(String(e)),null}));case 6:t=e.sent,ne(!1);case 8:Array.isArray(t)&&t.length&&(r=B(t),a=r.data,c=r.fields,w({fields:c,dataSource:a,filename:"list.csv"}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=Object(h.useCallback)((function(e,t,n){fe(Object(f.a)(Object(f.a)({},n),{},{Page:e,PageSize:t})),R&&Oe({FuzzySearch:ue,Page:e,PageSize:t})}),[]),ve=Object(h.useRef)(Object(S.g)((function(e,t,n){fe({Page:e,PageSize:t}),n&&Oe({FuzzySearch:ue,Page:e,PageSize:t})}),1e3)),ge=function(){if(E){ve.current(1,je.PageSize||10,R)}},ye=Object(h.useCallback)((function(){return Object(f.a)(Object(f.a)({dataSource:R&&E?J:null===J||void 0===J?void 0:J.filter((function(e){return!ue||Object.keys(e).some((function(t){return typeof e[t]!==Object&&String(e[t]).includes(ue)}))}))},R?{pagination:{current:je.Page,pageSize:je.PageSize,total:H,onChange:function(e,t){return me(e,t,je)}}}:{}),{},{scroll:{x:!0}})}),[J,ue,H,R,E,je,me]),xe=Object(C.jsx)(P,{style:{width:150},options:n.map((function(e){return{label:e.title,value:e.key}})),value:ce.map((function(e){return e.key})),onChange:function(e){var t=n.filter((function(t){return e.includes(t.key)}));ie(t),d&&function(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch(n){console.log(n.message)}}(d,t.map((function(e){return e.key})))}}),we=Object(C.jsxs)(c.b,{children:[A?Object(C.jsx)(u.a,{size:L,suffix:Object(C.jsx)(m.a,{onClick:ge}),value:ue,onChange:function(e){return se(e.target.value)},placeholder:"search...",onPressEnter:ge}):null,F&&Object(C.jsx)(l.a,{size:L,loading:te,onClick:he,icon:Object(C.jsx)(v.a,{})}),D?Object(C.jsx)(l.a,{size:L,onClick:function(){return Oe(Object(f.a)({},pe()))},icon:Object(C.jsx)(g.a,{})}):null,d&&Object(C.jsx)(i.a,{placement:"top",title:"\u81ea\u5b9a\u4e49\u5217\u8868",children:Object(C.jsx)(o.a,{placement:"left",title:"\u81ea\u5b9a\u4e49\u5217\u8868",content:xe,trigger:"click",children:Object(C.jsx)(l.a,{size:L,icon:Object(C.jsx)(y.a,{})})})},"ColumnsSetting")]});return Object(C.jsx)(r.a,{size:L,title:I,extra:we,children:Object(C.jsx)(a.a,Object(f.a)({size:L,columns:ce,rowKey:x,loading:Y,bordered:!0,onChange:function(e,t,n){console.log(n),Oe(Object(f.a)({},pe({pagination:e,filters:t,sorter:n})))}},ye()))})}));z.defaultProps={usePagination:!1,size:"middle",useBackendSearch:!1},z.displayName="UTable";t.a=z},403:function(e,t,n){"use strict";n(379);var r=n(151),a=n(461),c=n.n(a),i={};var o="user",l="123456";t.a=function(e){return new Promise((function(t,n){var a=c.a.create(Object.assign({withCredentials:!1,"content-type":"application/json",timeout:3e4},i));a.interceptors.request.use((function(e){return l&&(e.headers.token=l),o&&(e.headers.remote_user=o),e}),(function(e){return n(e)})),a.interceptors.response.use((function(e){return e}),(function(e){return n(e.message)})),a(e).then((function(e){var n=e.data,a=n.RetCode,c=n.Message,i=e.data;if(1e4===a)return r.b.error("\u8bf7\u767b\u9646"),void window.location.replace("/login");0!==a?(r.b.error(c),t(i)):t(i)})).catch((function(e){n(e)}))}))}},448:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return b}));var r=n(403),a=function(e){return Object(r.a)({url:"/v1/signIn",method:"post",data:e})},c=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},i=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},o=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},l=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},u=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},s=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},d=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})},b=function(e){return Object(r.a)({url:"/v1/list",method:"get",query:e})}},453:function(e,t,n){"use strict";n(584);var r=n(588),a=n(364),c=(n(219),n(63)),i=n(43),o=n(0),l=(n(217),n(98)),u=n(455),s=(n(401),n(398)),d=n(4),b=["content","label","option","render"],j=s.a.Option;var f=function(e){var t=e.content,n=e.label,r=e.option,c=e.render,i=Object(u.a)(e,b),o={Input:Object(d.jsx)(l.a,{placeholder:"\u8bf7\u8f93\u5165"}),Textarea:Object(d.jsx)(l.a.TextArea,Object(a.a)({style:{width:"100%"},placeholder:n},r)),Select:Object(d.jsx)(s.a,Object(a.a)(Object(a.a)({showSearch:!0},i),{},{optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:r&&r.list?r.list.map((function(e,t){var n=Array.isArray(r.label)?"".concat(e[r.label[0]],"\uff08").concat(e[r.label[1]],"\uff09"):e[r.label];return Object(d.jsx)(j,{value:e[r.value],label:n,children:n},t)})):null})),SelectNew:Object(d.jsx)(s.a,Object(a.a)(Object(a.a)({showSearch:!0,style:{width:200}},i),{},{optionFilterProp:"children",filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:r&&r.list?r.list.map((function(e,t){return Object(d.jsx)(j,{value:e.value,label:e.label,children:e.label},t)})):null}))};return c||o[t]},O={labelCol:{span:6},wrapperCol:{span:16}};t.a=function(e){var t=e.itemOption,n=e.title,l=e.visible,u=e.cancel,s=e.handleOk,b=e.initialValues,j=e.confirmLoading,p=e.width,h=e.layout,m=e.editInfo,v=e.rest,g=c.a.useForm(),y=Object(i.a)(g,1)[0];return Object(o.useEffect)((function(){return m&&console.log("editInfo",m),function(){y.resetFields()}}),[l,y,m]),Object(d.jsx)(o.Fragment,{children:Object(d.jsx)(r.a,Object(a.a)(Object(a.a)({forceRender:!0,title:n||(m&&0===Object.keys(m).length?"\u65b0\u589e":"\u7f16\u8f91"),visible:l,onOk:function(){y.validateFields().then((function(e){s(e)})).catch((function(e){console.log("err",e)}))},onCancel:u,width:p,confirmLoading:j},v),{},{children:Object(d.jsx)(c.a,Object(a.a)(Object(a.a)({form:y},h||O),{},{initialValues:b,children:t?t.map((function(e,t){return Object(d.jsx)(c.a.Item,{label:e.label,name:e.name,rules:[Object(a.a)({},e.rules)],children:f(e)},t)})):null}))}))})}},454:function(e,t,n){"use strict";n(370);var r=n(373),a=(n(97),n(47)),c=(n(154),n(60)),i=n(364),o=(n(155),n(41)),l=(n(219),n(63)),u=n(43),s=n(0),d=(n(496),n(745)),b=n(157),j=(n(458),n(452)),f=(n(585),n(595)),O=(n(217),n(98)),p=(n(586),n(587)),h=(n(401),n(398)),m=n(4),v=h.a.Option,g=p.a.RangePicker;function y(e){var t={Input:Object(m.jsx)(O.a,{style:{width:"100%"},placeholder:e.placeholder||e.label,disabled:e.disabled}),TextArea:Object(m.jsx)(O.a.TextArea,Object(i.a)({style:{width:"100%"},placeholder:e.label},e.option)),NumberInput:Object(m.jsx)(f.a,{style:{width:"100%"},placeholder:e.label}),Select:Object(m.jsx)(h.a,{style:{width:"100%"},placeholder:e.label,showSearch:!0,allowClear:!0,disabled:e.disabled||!1,filterOption:function(e,t){try{return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}catch(n){return t.props.children.indexOf(e)>=0}},children:e.options?e.options.map((function(e,t){return Object(m.jsx)(v,{value:e.value,children:e.name||e.label},t)})):null}),SelectMultiple:Object(m.jsx)(h.a,{style:{width:"100%"},mode:"multiple",allowClear:!0,placeholder:e.label,filterOption:function(e,t){try{return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}catch(n){return t.props.children.indexOf(e)>=0}},children:e.options?e.options.map((function(e,t){return Object(m.jsx)(v,{value:e.value,children:e.name||e.label},t)})):null}),Radio:Object(m.jsx)(j.a.Group,Object(i.a)({options:e.options,optionType:"button",buttonStyle:"solid"},e.option)),Date:Object(m.jsx)(p.a,Object(i.a)({},e.option)),DateRange:Object(m.jsx)(g,Object(i.a)({},e.option)),Content:e.content};return e.content||t[e.type]}t.a=function(e){var t=e.fields,n=e.onSearch,j=e.rowCount,f=e.defaultValue,O=e.leftActions,p=e.rightActions,h=e.defaultExpand,v=l.a.useForm(),g=Object(u.a)(v,1)[0],x=j||4,w=Object(s.useState)((function(){return h||!1})),S=Object(u.a)(w,2),k=S[0],C=S[1];return Object(s.useEffect)((function(){f&&g.setFieldsValue(f)}),[]),Object(m.jsxs)(l.a,{form:g,name:"advanced_search",onFinish:function(e){var t=Object(i.a)({},e);Object.keys(t).forEach((function(e){(""===t[e]||Array.prototype.isPrototypeOf(t[e])&&0===t[e].length||Object.prototype.isPrototypeOf(t[e])&&0===Object.keys(t[e]).length)&&delete t[e]})),n(t)},children:[t&&t.length>0&&Object(m.jsx)(c.a,{gutter:24,children:function(){var e=k?t:t.slice(0,x),n=[];return e.forEach((function(e){e.hidden||n.push(Object(m.jsx)(o.a,{span:e.span?e.span:6,children:Object(m.jsx)(l.a.Item,{name:e.key,label:e.label,required:e.required,children:y(e)})},e.key))})),n}()}),Object(m.jsxs)(c.a,{children:[Object(m.jsx)(o.a,{span:14,children:O?O.map((function(e,t){return Object(m.jsx)(s.Fragment,{children:e},t)})):null}),Object(m.jsxs)(o.a,{span:10,className:"table-filter-col",children:[t&&t.length>0&&Object(m.jsxs)(r.b,{className:"table-filter-button-group",children:[Object(m.jsx)(a.a,{type:"primary",htmlType:"submit",size:"small",children:"\u641c\u7d22"}),Object(m.jsx)(a.a,{size:"small",onClick:function(){g.resetFields(),g.setFieldsValue(f)},children:"\u91cd\u7f6e"}),t&&t.length>x?Object(m.jsxs)(a.a,{type:"link",style:{padding:0},onClick:function(){C(!k)},children:[k?Object(m.jsx)(d.a,{}):Object(m.jsx)(b.a,{})," \u66f4\u591a"]}):null]}),p?p.map((function(e,t){return Object(m.jsx)("span",{children:e},t)})):null]})]})]})}},496:function(e,t,n){},756:function(e,t,n){"use strict";n.r(t);n(97);var r=n(47),a=(n(216),n(150)),c=n(149),i=n(361),o=n.n(i),l=n(364),u=n(388),s=n(43),d=n(0),b=(n(370),n(373)),j=n(20),f=n(4),O=function(e){var t=e.handleEdit;return[{title:"ID",dataIndex:"ID",key:"ID"},{title:"\u540d\u79f0",dataIndex:"Name",key:"Name"},{title:"\u6807\u8bc6",dataIndex:"Role",key:"Role"},{title:"\u8bf4\u660e",dataIndex:"Description",key:"Description"},{title:"\u521b\u5efa\u4eba",dataIndex:"createdBy",key:"createdBy",render:function(e){return e||"-"}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"CreateTime",key:"CreateTime",render:function(e){return Object(j.c)(e)}},{title:"\u64cd\u4f5c",render:function(e){return Object(f.jsx)(b.b,{children:Object(f.jsx)(r.a,{type:"link",size:"small",onClick:function(){return t(e)},children:"\u7f16\u8f91"})})}}]},p=n(399),h=n(453),m=n(448),v=(n(739),n(743)),g={},y=function(e){var t=e.rewritePermissions,n=e.targetKeys,r=e.handleChange;return[{name:"nameCn",label:"\u89d2\u8272\u540d\u79f0",content:"Input",rules:{required:!0}},{name:"name",label:"\u89d2\u8272\u6807\u8bc6",content:"Input",rules:{required:!0}},{name:"describe",label:"\u63cf\u8ff0",content:"Textarea"},{name:"resourceIds",label:"\u8d44\u6e90",rules:{required:!0},render:Object(f.jsx)(v.a,{dataSource:t,titles:["\u5f85\u8d4b\u6743\u5217\u8868","\u5df2\u8d4b\u6743\u5217\u8868"],targetKeys:n,render:function(e){return e.name},showSearch:!0,onChange:r,listStyle:{width:250,height:250}})}]},x=n(454);var w=function(){return[{label:"\u540d\u79f0",key:"Name",type:"Input",span:8},{label:"\u8d44\u6e90\u6807\u8bc6",key:"Role",type:"Input",span:8}]};t.default=function(){var e=Object(d.useState)([]),t=Object(s.a)(e,2),n=t[0],i=t[1],b=Object(d.useState)(!1),j=Object(s.a)(b,2),v=j[0],S=j[1],k=Object(d.useState)(!1),C=Object(s.a)(k,2),P=C[0],z=C[1],I=Object(d.useState)(!1),F=Object(s.a)(I,2),q=F[0],L=F[1],R=Object(d.useState)([]),E=Object(s.a)(R,2),D=E[0],A=E[1],N=Object(d.useState)([]),T=Object(s.a)(N,2),B=T[0],K=T[1],V=Object(d.useState)(!0),U=Object(s.a)(V,2),J=U[0],M=U[1],G=Object(d.useState)({}),_=Object(s.a)(G,2),H=_[0],Q=_[1];Object(d.useEffect)((function(){X()}),[]),Object(d.useEffect)((function(){P&&K([])}),[P]);var W=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t.id);case 3:n=e.sent,r=n.resourceList.map((function(e){return e.resourceId})),A(r),M(!1),Q(Object(l.a)(Object(l.a)({},t),{},{resourceIds:r})),z(!0),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("err",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){S(!0),i([])},Y=function(e){var t=e.category,n=e.nameCn;return t?"".concat(n):n},Z=n.map((function(e){return{key:e.id,name:Y(e)}})),$=function(){};return Object(f.jsxs)(d.Fragment,{children:[Object(f.jsx)(a.a,{className:"m-b-10",children:Object(f.jsx)(x.a,{onSearch:function(){},fields:w(),rowCount:3,defaultValue:g})}),Object(f.jsx)(p.a,{rowKey:"ID",columns:O({handleEdit:W}),useReloadButton:!0,leftAction:Object(f.jsx)(r.a,{type:"primary",onClick:function(){z(!0)},children:"\u521b\u5efa\u89d2\u8272"}),useBackendPagination:!0,query:m.f,loading:v}),Object(f.jsx)(h.a,{width:800,itemOption:y({targetKeys:D,rewritePermissions:Z,handleChange:function(e){A(e)}}),visible:P,cancel:function(){return z(!1)},handleOk:function(e){J||(e.id=H.id),L(!0)},title:J?"\u65b0\u589e":"\u7f16\u8f91",isNew:J,confirmLoading:q,onSelectChange:function(e,t){K([].concat(Object(c.a)(e),Object(c.a)(t)))},selectedKeys:B,initialValues:H})]})}}}]);
//# sourceMappingURL=10.666c0ee3.chunk.js.map